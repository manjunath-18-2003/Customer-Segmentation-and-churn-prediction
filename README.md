# Customer-Segmentation-and-churn-prediction

# -*- coding: utf-8 -*-
"""project

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1XEKQ_aLZ2ISLRhYUBWgLAo4UqcBtvjb1
"""

import numpy as np
import matplotlib.pyplot as plt
from sklearn.cluster import KMeans

X= np.array([[5,2,1],[7,3,1],[52,22,3],[45,23,1],
             [2,2,3],[4,3,1],[4,6,7],[45,23,1],
             [6,2,3],[43,44,5],[4,1,1],[47,22,1]

])

Kmeans = KMeans(n_clusters=3, random_state=42, n_init=10)
labels = Kmeans.fit_predict(X)
centroids = Kmeans.cluster_centers_

plt.scatter(X[:,0],X[:,1],c=labels,cmap='viridis',s=100,edgecolor='k')
plt.scatter(centroids[:,0],centroids[:,1],color='red',marker='X',s=200,label='centroids')
plt.xlabel("Avg Watch Time (hrs/week)")
plt.ylabel("Subscription Age(months)") # Added y-label for completeness
plt.title("OOT Customer Segmentation") # Added title for completeness
plt.legend() # Added legend for completeness
plt.show() # Display the plot
 
   
# churn-predition 
import numpy as np
import matplotlib.pyplot as plt
import pandas as pd # Added import for pandas
from sklearn.cluster import KMeans
from sklearn.model_selection import train_test_split # Added import
from sklearn.tree import DecisionTreeClassifier, plot_tree # Added import for plot_tree
from sklearn.metrics import accuracy_score # Added import

data={
    'Watch_Hours':[5,7,2,25,24,22,99,56,3,1,43,78],
    'Subscription_Age':[2,3,4,5,44,34,1,22,33,49,22,34],
    'Devices':[1,2,3,1,2,4,5,2,3,6,7,9],
    'churn':[1,0,1,1,0,1,0,1,1,0,0,1] # 1=churn,0=stay
}
df=pd.DataFrame(data)

# Handle missing values by dropping rows (for simplicity in this example)
df = df.dropna()

x=df[['Watch_Hours','Subscription_Age','Devices']]
y=df['churn']

x_train,x_test,y_train,y_test=train_test_split(x,y,test_size=0.2,random_state=42) # Removed redundant 'x='
dt_model=DecisionTreeClassifier(max_depth=5,random_state=42) # Corrected max_dept to max_depth
dt_model.fit(x_train,y_train)
y_pred=dt_model.predict(x_test) # Corrected X_test to x_test
acc=accuracy_score(y_test,y_pred) # Corrected accurracy_score to accuracy_score
print(f"Decision Tree Accuracy: {acc:.2f}")
plt.figure(figsize=(12,6))
plot_tree(dt_model,feature_names=x.columns,class_names=['stay','churn'],filled=True,rounded=True) # Corrected filled_names to feature_names and X.columns to x.columns
plt.show() # Corrected plot.show() to plt.show()

from google.colab import drive
drive.mount('/content/drive')
